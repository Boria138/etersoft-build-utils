#!/bin/sh

# load common functions, compatible with local and installed script
#. `dirname $0`/../share/eterbuild/functions/common

#test -n "$SPECNAME" || SPECNAME=$(basename `pwd`).spec

if [ "$1" = "-h" ] ; then
	echo "gpush - publish current project repo to git.alt"
	echo "Use: gpush without parameters"
	exit 1
fi

PROJECTNAME=$(basename `pwd`)

CURRENTBRANCH=$(git branch | grep "^\*" | cut -d " " -f 2)

if [ -z "$CURRENTBRANCH" ] ; then
	echo "Can't detect current branch"
	exit 1
fi

git push $@ git.alt:packages/$PROJECTNAME.git $CURRENTBRANCH:master
git push --tags git.alt:packages/$PROJECTNAME.git $CURRENTBRANCH:master

#> $ git commit -a; A='0.23-alt1'; git tag -s $A; \
#>   git tag -s -f -m 'Sisyphus release $A' sisyphus $A
