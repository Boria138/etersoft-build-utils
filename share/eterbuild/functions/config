#!/bin/bash
# 2008-2010 Etersoft www.etersoft.ru
# Author: Vitaly Lipatov <lav@etersoft.ru>
# Public domain

ETERBUILDVERSION=185

SUDO="sudo"

# for some shells? not for bash
test -z "$UID" && UID=`id -u`
if [ $UID = "0" ]; then
	SUDO=""
fi

# Get tmp dir for our using
OURTMPDIR=$TMPDIR
[ -z "$OURTMPDIR" ] || [ -d "$OURTMPDIR" ] || OURTMPDIR=/tmp

# detect our arch
SYSARCH=$(uname -m)
[ "$SYSARCH" = "x86_64" ] || SYSARCH=i586

[ -n "$DEFAULTARCH" ] || DEFAULTARCH=$SYSARCH

NICE="nice"
RPMBUILD=rpmbuild

RPMDIR="$HOME/RPM"
# Can be overrided in the scripts
[ -n "$RPMTOPDIR" ] || RPMTOPDIR="$RPMDIR"

[ -n "$APTCONFBASE" ] || APTCONFBASE=$ETERBUILDETC/apt/apt.conf

#OWNERMAIL=`grep "^%packager" ~/.rpmmacros | head -n 1 | sed -e "s/%packager[ \t]*//g"`
# works only on ALT?
OWNERMAIL=`rpm --eval %packager`

COMPANYFTP=etersoft.ru
TARGETFTPBASE="/var/ftp"
LOGDIR="$RPMDIR/log"
HASHERBASEDIR="$HOME/hasher"
HASHER_NOCHECK=nvr,gpg,packager,buildtime
HASHERARG=""

# for use in help as example branch/distro name
CURRENTBRANCHNAME="M51"

[ -n "$DEBUG" ] && HASHERARG="-v $HASHERARG"

#SSH_KEYFILE=~/.ssh/id_dsa
GIRARHOST=git.alt
# Timeout in sec for ssh commands
SSHTIMEOUT=300

BUILDSERVER=

# TODO: use common ccache dir
export CCACHE_DIR=$OURTMPDIR/ccache

# enable ccache using
# CCACHE_ENABLE=yes

# load system wide config
test -f /etc/eterbuild/config && . /etc/eterbuild/config

# load user config files
if [ -f ~/.config/eterbuild ] ; then
	. ~/.config/eterbuild
elif [ -f ~/.eterbuild-config ] ; then
	. ~/.eterbuild-config
	warning "./eterbuild-config is obsoleted, use ~/.config/eterbuild instead"
else
	if [ -f ~/.ebconfig ] ; then
		fatal "./ebconfig is obsoleted, use ~/.config/eterbuild instead"
	fi
fi

