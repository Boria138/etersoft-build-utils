#!/bin/bash
# 2008-2010 Etersoft www.etersoft.ru
# Author: Vitaly Lipatov <lav@etersoft.ru>
# Public domain

ETERBUILDVERSION=2100

SUDO="sudo"

# for some shells? not for bash
test -z "$UID" && UID=`id -u`
if [ $UID = "0" ]; then
	SUDO=""
fi

# Get tmp dir for our using
OURTMPDIR=$TMPDIR
[ -z "$OURTMPDIR" ] || [ -d "$OURTMPDIR" ] || OURTMPDIR=/tmp

# current arch
SYSARCH=$(uname -m)
[ "$SYSARCH" = "x86_64" ] || SYSARCH=i586

# set default target arch
[ -n "$BUILDARCH" ] || BUILDARCH=$SYSARCH

NICE="nice"
RPMBUILD=rpmbuild

# CHECKME: works only on ALT?
RPMDIR=`rpm --eval %_topdir`
RPMTMPDIR=`rpm --eval %_tmppath`

# Can be overrided in the scripts
[ -n "$RPMTOPDIR" ] || RPMTOPDIR="$RPMDIR"

[ -n "$APTCONFBASE" ] || APTCONFBASE=$ETERBUILDETC/apt/apt.conf

#OWNERMAIL=`grep "^%packager" ~/.rpmmacros | head -n 1 | sed -e "s/%packager[ \t]*//g"`
# works only on ALT?
OWNERMAIL=`rpm --eval %packager`

COMPANYFTP=etersoft.ru
TARGETFTPBASE="/var/ftp"
LOGDIR="$RPMDIR/log"
HASHERBASEDIR="$HOME/hasher"
HASHER_NOCHECK=nvr,gpg,packager,buildtime
HASHERARG=""

# TODO: do not use this notation at all
# for use in help as example branch/distro name
EXAMPLEALTDISTRVERSION="p6"
CURRENTBRANCHNAME="M60"

# Build for Sisyphus by default
MENV=SS

[ -n "$DEBUG" ] && HASHERARG="-v $HASHERARG"

#SSH_KEYFILE=~/.ssh/id_dsa
GIRARHOST=git.alt
GIRARURL="http://git.altlinux.org"

# Timeout in sec for ssh commands
SSHTIMEOUT=300

BUILDSERVER=

# TODO: use common ccache dir
export CCACHE_DIR=$OURTMPDIR/ccache

# enable ccache using
# CCACHE_ENABLE=yes

# load system wide config
[ -f /etc/eterbuild/config ] && . /etc/eterbuild/config

# load user config files
if [ -f ~/.config/eterbuild ] ; then
	. ~/.config/eterbuild
elif [ -f ~/.eterbuild-config ] ; then
	fatal "./eterbuild-config is obsoleted, use ~/.config/eterbuild instead"
fi

